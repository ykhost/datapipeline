[2022-03-14 17:32:57,280] {taskinstance.py:670} INFO - Dependencies all met for <TaskInstance: twitter_dag.twitter_bbb22 2022-03-09T09:00:00+00:00 [queued]>
[2022-03-14 17:32:57,284] {taskinstance.py:670} INFO - Dependencies all met for <TaskInstance: twitter_dag.twitter_bbb22 2022-03-09T09:00:00+00:00 [queued]>
[2022-03-14 17:32:57,284] {taskinstance.py:880} INFO - 
--------------------------------------------------------------------------------
[2022-03-14 17:32:57,285] {taskinstance.py:881} INFO - Starting attempt 1 of 1
[2022-03-14 17:32:57,285] {taskinstance.py:882} INFO - 
--------------------------------------------------------------------------------
[2022-03-14 17:32:57,290] {taskinstance.py:901} INFO - Executing <Task(TwitterOperator): twitter_bbb22> on 2022-03-09T09:00:00+00:00
[2022-03-14 17:32:57,292] {standard_task_runner.py:54} INFO - Started process 20777 to run task
[2022-03-14 17:32:57,322] {standard_task_runner.py:77} INFO - Running: ['airflow', 'run', 'twitter_dag', 'twitter_bbb22', '2022-03-09T09:00:00+00:00', '--job_id', '41', '--pool', 'default_pool', '--raw', '-sd', 'DAGS_FOLDER/twitter_dag.py', '--cfg_path', '/tmp/tmp6egdhwhf']
[2022-03-14 17:32:57,322] {standard_task_runner.py:78} INFO - Job 41: Subtask twitter_bbb22
[2022-03-14 17:32:57,337] {logging_mixin.py:112} INFO - Running <TaskInstance: twitter_dag.twitter_bbb22 2022-03-09T09:00:00+00:00 [running]> on host 1a222f561522
[2022-03-14 17:32:57,369] {base_hook.py:89} INFO - Using connection to: id: twitter_default. Host: https://api.twitter.com, Port: None, Schema: None, Login: None, Password: None, extra: XXXXXXXX
[2022-03-14 17:32:57,371] {twitter_hook.py:37} INFO - URL: https://api.twitter.com/2/tweets/search/recent?query=jade&tweet.fields=author_id,conversation_id,created_at,id,in_reply_to_user_id,public_metrics,text&expansions=author_id&user.fields=id,name,username,created_at&start_time=2022-03-09T09:00:00.00Z&end_time=2022-03-10T09:00:00.00Z
[2022-03-14 17:32:57,390] {logging_mixin.py:112} WARNING - /run/datapipeline/.env/lib/python3.8/site-packages/urllib3/connectionpool.py:981: InsecureRequestWarning: Unverified HTTPS request is being made to host 'api.twitter.com'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#ssl-warnings
  warnings.warn(
[2022-03-14 17:32:57,537] {http_hook.py:150} ERROR - HTTP error: Too Many Requests
[2022-03-14 17:32:57,537] {http_hook.py:151} ERROR - {"title":"Too Many Requests","detail":"Too Many Requests","type":"about:blank","status":429}
[2022-03-14 17:32:57,539] {taskinstance.py:1150} ERROR - 429:Too Many Requests
Traceback (most recent call last):
  File "/run/datapipeline/.env/lib/python3.8/site-packages/airflow/hooks/http_hook.py", line 148, in check_response
    response.raise_for_status()
  File "/run/datapipeline/.env/lib/python3.8/site-packages/requests/models.py", line 941, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://api.twitter.com/2/tweets/search/recent?query=jade&tweet.fields=author_id,conversation_id,created_at,id,in_reply_to_user_id,public_metrics,text&expansions=author_id&user.fields=id,name,username,created_at&start_time=2022-03-09T09:00:00.00Z&end_time=2022-03-10T09:00:00.00Z

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/run/datapipeline/.env/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 984, in _run_raw_task
    result = task_copy.execute(context=context)
  File "/run/datapipeline/airflow/plugins/operators/twitter_operator.py", line 50, in execute
    for pg in hook.run():
  File "/run/datapipeline/airflow/plugins/hooks/twitter_hook.py", line 55, in run
    yield from self.paginate(url, session)
  File "/run/datapipeline/airflow/plugins/hooks/twitter_hook.py", line 45, in paginate
    data = self.connect_to_endpoint(full_url, session)
  File "/run/datapipeline/airflow/plugins/hooks/twitter_hook.py", line 38, in connect_to_endpoint
    return self.run_and_check(session, prep, {}).json()
  File "/run/datapipeline/.env/lib/python3.8/site-packages/airflow/hooks/http_hook.py", line 181, in run_and_check
    self.check_response(response)
  File "/run/datapipeline/.env/lib/python3.8/site-packages/airflow/hooks/http_hook.py", line 152, in check_response
    raise AirflowException(str(response.status_code) + ":" + response.reason)
airflow.exceptions.AirflowException: 429:Too Many Requests
[2022-03-14 17:32:57,540] {taskinstance.py:1187} INFO - Marking task as FAILED. dag_id=twitter_dag, task_id=twitter_bbb22, execution_date=20220309T090000, start_date=20220314T173257, end_date=20220314T173257
[2022-03-14 17:33:02,277] {local_task_job.py:102} INFO - Task exited with return code 1
[2022-03-14 18:08:31,803] {taskinstance.py:670} INFO - Dependencies all met for <TaskInstance: twitter_dag.twitter_bbb22 2022-03-09T09:00:00+00:00 [queued]>
[2022-03-14 18:08:31,809] {taskinstance.py:670} INFO - Dependencies all met for <TaskInstance: twitter_dag.twitter_bbb22 2022-03-09T09:00:00+00:00 [queued]>
[2022-03-14 18:08:31,809] {taskinstance.py:880} INFO - 
--------------------------------------------------------------------------------
[2022-03-14 18:08:31,809] {taskinstance.py:881} INFO - Starting attempt 1 of 1
[2022-03-14 18:08:31,809] {taskinstance.py:882} INFO - 
--------------------------------------------------------------------------------
[2022-03-14 18:08:31,816] {taskinstance.py:901} INFO - Executing <Task(TwitterOperator): twitter_bbb22> on 2022-03-09T09:00:00+00:00
[2022-03-14 18:08:31,818] {standard_task_runner.py:54} INFO - Started process 15201 to run task
[2022-03-14 18:08:31,851] {standard_task_runner.py:77} INFO - Running: ['airflow', 'run', 'twitter_dag', 'twitter_bbb22', '2022-03-09T09:00:00+00:00', '--job_id', '52', '--pool', 'default_pool', '--raw', '-sd', 'DAGS_FOLDER/twitter_dag.py', '--cfg_path', '/tmp/tmp_tv3wt9q']
[2022-03-14 18:08:31,852] {standard_task_runner.py:78} INFO - Job 52: Subtask twitter_bbb22
[2022-03-14 18:08:31,868] {logging_mixin.py:112} INFO - Running <TaskInstance: twitter_dag.twitter_bbb22 2022-03-09T09:00:00+00:00 [running]> on host 1a222f561522
[2022-03-14 18:08:31,900] {base_hook.py:89} INFO - Using connection to: id: twitter_default. Host: https://api.twitter.com, Port: None, Schema: None, Login: None, Password: None, extra: XXXXXXXX
[2022-03-14 18:08:31,901] {twitter_hook.py:37} INFO - URL: https://api.twitter.com/2/tweets/search/recent?query=jade&tweet.fields=author_id,conversation_id,created_at,id,in_reply_to_user_id,public_metrics,text&expansions=author_id&user.fields=id,name,username,created_at&start_time=2022-03-09T09:00:00.00Z&end_time=2022-03-10T09:00:00.00Z
[2022-03-14 18:08:31,920] {logging_mixin.py:112} WARNING - /run/datapipeline/.env/lib/python3.8/site-packages/urllib3/connectionpool.py:981: InsecureRequestWarning: Unverified HTTPS request is being made to host 'api.twitter.com'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#ssl-warnings
  warnings.warn(
[2022-03-14 18:08:32,067] {http_hook.py:150} ERROR - HTTP error: Too Many Requests
[2022-03-14 18:08:32,067] {http_hook.py:151} ERROR - {"title":"Too Many Requests","detail":"Too Many Requests","type":"about:blank","status":429}
[2022-03-14 18:08:32,069] {taskinstance.py:1150} ERROR - 429:Too Many Requests
Traceback (most recent call last):
  File "/run/datapipeline/.env/lib/python3.8/site-packages/airflow/hooks/http_hook.py", line 148, in check_response
    response.raise_for_status()
  File "/run/datapipeline/.env/lib/python3.8/site-packages/requests/models.py", line 941, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://api.twitter.com/2/tweets/search/recent?query=jade&tweet.fields=author_id,conversation_id,created_at,id,in_reply_to_user_id,public_metrics,text&expansions=author_id&user.fields=id,name,username,created_at&start_time=2022-03-09T09:00:00.00Z&end_time=2022-03-10T09:00:00.00Z

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/run/datapipeline/.env/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 984, in _run_raw_task
    result = task_copy.execute(context=context)
  File "/run/datapipeline/airflow/plugins/operators/twitter_operator.py", line 50, in execute
    for pg in hook.run():
  File "/run/datapipeline/airflow/plugins/hooks/twitter_hook.py", line 55, in run
    yield from self.paginate(url, session)
  File "/run/datapipeline/airflow/plugins/hooks/twitter_hook.py", line 45, in paginate
    data = self.connect_to_endpoint(full_url, session)
  File "/run/datapipeline/airflow/plugins/hooks/twitter_hook.py", line 38, in connect_to_endpoint
    return self.run_and_check(session, prep, {}).json()
  File "/run/datapipeline/.env/lib/python3.8/site-packages/airflow/hooks/http_hook.py", line 181, in run_and_check
    self.check_response(response)
  File "/run/datapipeline/.env/lib/python3.8/site-packages/airflow/hooks/http_hook.py", line 152, in check_response
    raise AirflowException(str(response.status_code) + ":" + response.reason)
airflow.exceptions.AirflowException: 429:Too Many Requests
[2022-03-14 18:08:32,070] {taskinstance.py:1187} INFO - Marking task as FAILED. dag_id=twitter_dag, task_id=twitter_bbb22, execution_date=20220309T090000, start_date=20220314T180831, end_date=20220314T180832
[2022-03-14 18:08:36,798] {local_task_job.py:102} INFO - Task exited with return code 1
[2022-03-14 18:28:50,025] {taskinstance.py:670} INFO - Dependencies all met for <TaskInstance: twitter_dag.twitter_bbb22 2022-03-09T09:00:00+00:00 [queued]>
[2022-03-14 18:28:50,029] {taskinstance.py:670} INFO - Dependencies all met for <TaskInstance: twitter_dag.twitter_bbb22 2022-03-09T09:00:00+00:00 [queued]>
[2022-03-14 18:28:50,029] {taskinstance.py:880} INFO - 
--------------------------------------------------------------------------------
[2022-03-14 18:28:50,030] {taskinstance.py:881} INFO - Starting attempt 1 of 1
[2022-03-14 18:28:50,030] {taskinstance.py:882} INFO - 
--------------------------------------------------------------------------------
[2022-03-14 18:28:50,035] {taskinstance.py:901} INFO - Executing <Task(TwitterOperator): twitter_bbb22> on 2022-03-09T09:00:00+00:00
[2022-03-14 18:28:50,036] {standard_task_runner.py:54} INFO - Started process 2594 to run task
[2022-03-14 18:28:50,066] {standard_task_runner.py:77} INFO - Running: ['airflow', 'run', 'twitter_dag', 'twitter_bbb22', '2022-03-09T09:00:00+00:00', '--job_id', '55', '--pool', 'default_pool', '--raw', '-sd', 'DAGS_FOLDER/twitter_dag.py', '--cfg_path', '/tmp/tmp_k_a76xf']
[2022-03-14 18:28:50,066] {standard_task_runner.py:78} INFO - Job 55: Subtask twitter_bbb22
[2022-03-14 18:28:50,081] {logging_mixin.py:112} INFO - Running <TaskInstance: twitter_dag.twitter_bbb22 2022-03-09T09:00:00+00:00 [running]> on host 1a222f561522
[2022-03-14 18:28:50,111] {base_hook.py:89} INFO - Using connection to: id: twitter_default. Host: https://api.twitter.com, Port: None, Schema: None, Login: None, Password: None, extra: XXXXXXXX
[2022-03-14 18:28:50,112] {twitter_hook.py:37} INFO - URL: https://api.twitter.com/2/tweets/search/recent?query=jade&tweet.fields=author_id,conversation_id,created_at,id,in_reply_to_user_id,public_metrics,text&expansions=author_id&user.fields=id,name,username,created_at&start_time=2022-03-09T09:00:00.00Z&end_time=2022-03-10T09:00:00.00Z
[2022-03-14 18:28:50,132] {logging_mixin.py:112} WARNING - /run/datapipeline/.env/lib/python3.8/site-packages/urllib3/connectionpool.py:981: InsecureRequestWarning: Unverified HTTPS request is being made to host 'api.twitter.com'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#ssl-warnings
  warnings.warn(
[2022-03-14 18:28:50,283] {http_hook.py:150} ERROR - HTTP error: Too Many Requests
[2022-03-14 18:28:50,283] {http_hook.py:151} ERROR - {"title":"Too Many Requests","detail":"Too Many Requests","type":"about:blank","status":429}
[2022-03-14 18:28:50,285] {taskinstance.py:1150} ERROR - 429:Too Many Requests
Traceback (most recent call last):
  File "/run/datapipeline/.env/lib/python3.8/site-packages/airflow/hooks/http_hook.py", line 148, in check_response
    response.raise_for_status()
  File "/run/datapipeline/.env/lib/python3.8/site-packages/requests/models.py", line 941, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://api.twitter.com/2/tweets/search/recent?query=jade&tweet.fields=author_id,conversation_id,created_at,id,in_reply_to_user_id,public_metrics,text&expansions=author_id&user.fields=id,name,username,created_at&start_time=2022-03-09T09:00:00.00Z&end_time=2022-03-10T09:00:00.00Z

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/run/datapipeline/.env/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 984, in _run_raw_task
    result = task_copy.execute(context=context)
  File "/run/datapipeline/airflow/plugins/operators/twitter_operator.py", line 50, in execute
    for pg in hook.run():
  File "/run/datapipeline/airflow/plugins/hooks/twitter_hook.py", line 55, in run
    yield from self.paginate(url, session)
  File "/run/datapipeline/airflow/plugins/hooks/twitter_hook.py", line 45, in paginate
    data = self.connect_to_endpoint(full_url, session)
  File "/run/datapipeline/airflow/plugins/hooks/twitter_hook.py", line 38, in connect_to_endpoint
    return self.run_and_check(session, prep, {}).json()
  File "/run/datapipeline/.env/lib/python3.8/site-packages/airflow/hooks/http_hook.py", line 181, in run_and_check
    self.check_response(response)
  File "/run/datapipeline/.env/lib/python3.8/site-packages/airflow/hooks/http_hook.py", line 152, in check_response
    raise AirflowException(str(response.status_code) + ":" + response.reason)
airflow.exceptions.AirflowException: 429:Too Many Requests
[2022-03-14 18:28:50,286] {taskinstance.py:1187} INFO - Marking task as FAILED. dag_id=twitter_dag, task_id=twitter_bbb22, execution_date=20220309T090000, start_date=20220314T182850, end_date=20220314T182850
[2022-03-14 18:28:55,022] {local_task_job.py:102} INFO - Task exited with return code 1
